<style>
  label {
    font-weight: bold;
  }
</style>
<div class="row">
  <div class="left" style="margin-left: 1%; font-size: 18px;">
    <%= render_breadcrumbs :separator => ' > ' %>
  </div>
  <div class="col s6 right">
    <div class="input-field" style="margin-top: 0">
      <%= form_tag(current_order_path, method: :get) do %>
          <%= text_field_tag :term, params[:term], style: 'width: 60%;', placeholder: 'Search', data: {autocomplete_source: Dish.order(:dish_name).map(&:dish_name)} %>
          <div class="col s3">
            <select name="type" onchange="onSelectType()" id="type">

              <% if params[:type] == "dish" %>
                  <option value="dish" selected>Dish</option>
              <% else %>
                  <option value="dish">Dish</option>
              <% end %>
              <% if params[:type] == "table" %>
                  <option value="table" selected>Table</option>
              <% else %>
                  <option value="table">Table</option>
              <% end %>
            </select>
          </div>
          <button type="submit" class="btn-floating waves-effect waves-light">
            <i class="material-icons">search</i>
          </button>
      <% end %>
    </div>
  </div>
</div>
<div style="padding: 0% 5%">
  <% if !@orders.nil? && @orders.size > 0 %>
      <div class="card">
        <div class="card-content">
          <span class="card-title">Current Order</span>
          <% if params[:type] == "table" %>
              <table id="table" class="bordered striped">
                <thead>
                <th style="text-align: center; width: 15%">User</th>
                <th style="text-align: center; width: 55%">Order Detail</th>
                </thead>
                <tbody id="tbody">
                <% @orders.each do |order| %>
                    <% dish_name = Array.new %>
                    <% order.order_details.each do |o| %>
                        <% if o.cooking_status == 0 || o.cooking_status == 1 %>
                            <% dish_name.push("#{o.dish.dish_name} x #{o.quantity}") %>
                        <% end %>
                    <% end %>
                    <% if dish_name.size > 0 %>
                        <tr>
                          <td style="text-align: center"><%= order.user.username %></td>
                          <td><%= dish_name.join(", ") %></td>
                        </tr>
                    <% end %>
                <% end %>
                </tbody>
              </table>
          <% elsif params[:type] == "dish" %>
              <table id="table" class="bordered striped">
                <thead>
                <th style="text-align: center; width: 15%">Table Number</th>
                <th style="text-align: center; width: 55%">Order Detail</th>
                </thead>
                <tbody id="tbody">
                <% @orders.each_with_index do |order, index| %>
                    <% dish_name = Array.new %>
                    <% order.order_details.each do |o| %>
                        <% if o.cooking_status == 0 || o.cooking_status == 1 %>
                            <% dish_name.push("#{o.dish.dish_name} x #{o.quantity}") %>
                        <% end %>
                    <% end %>
                    <tr>
                      <td style="text-align: center"><%= order.table_number %></td>
                      <td><%= dish_name.join(", ") %></td>
                    </tr>
                <% end %>
                </tbody>
              </table>
          <% end %>
        </div>
      </div>
  <% elsif !params[:term].nil? %>
      <h5 id="available" style="text-align: center;">Not Available</h5>
  <% end %>
</div>
<script>
    $('#term').autocomplete({
        source: $('#term').data('autocomplete-source')
    });
    function onSelectType() {
        var selected = $('#type').find(":selected").text();
        if (selected == "Dish") {
            $('#term').autocomplete("enable");
        } else {
            $('#term').autocomplete("disable");
        }
    }
</script>